<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ú¯Ø§Ù…â€ŒØ¨Ù‡â€ŒÚ¯Ø§Ù… Ø¹Ø¯Ø¯ÛŒ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
<style>
body {
    font-family: 'Vazirmatn', sans-serif;
    background: linear-gradient(180deg, #f5f7fa, #c3cfe2);
    text-align: center;
    padding: 40px;
}
h1 { color: #222; margin-bottom: 20px; }
input, button {
    padding: 10px;
    margin: 8px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
}
button {
    cursor: pointer;
    background-color: #3b82f6;
    color: #fff;
    border: none;
    transition: 0.2s;
}
button:hover { background-color: #2563eb; }
#steps {
    margin-top: 25px;
    text-align: left;
    display: inline-block;
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 15px #bbb;
    max-width: 600px;
    min-height: 100px;
    direction: rtl;
    font-size: 17px;
}
.step { margin-bottom: 12px; animation: fadeIn 0.4s ease; }
@keyframes fadeIn {
    from {opacity: 0; transform: translateY(5px);}
    to {opacity: 1; transform: translateY(0);}
}
</style>
</head>
<body>

<h1>ğŸ§® Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ú¯Ø§Ù…â€ŒØ¨Ù‡â€ŒÚ¯Ø§Ù… Ø¹Ø¯Ø¯ÛŒ</h1>

<input type="text" id="question" placeholder="Ù…Ø«Ø§Ù„: 2^3 + sqrt(16) - 5">
<br>
<button id="startButton">Ø´Ø±ÙˆØ¹ Ú¯Ø§Ù…â€ŒØ¨Ù‡â€ŒÚ¯Ø§Ù…</button>
<button id="nextButton" style="display:none;">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ âœ</button>

<div id="steps"></div>

<script>
let steps = [];
let currentStep = 0;

// Ø¨Ø±Ø±Ø³ÛŒ ØªØ¹Ø§Ø¯Ù„ Ù¾Ø±Ø§Ù†ØªØ²Ù‡Ø§
function isBalanced(expr) {
    let stack = [];
    for (let ch of expr) {
        if (ch === '(') stack.push(ch);
        else if (ch === ')') {
            if (stack.length === 0) return false;
            stack.pop();
        }
    }
    return true;
}

// Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ø±Ø§Ø­Ù„
function prepareSteps() {
    const exprInput = document.getElementById('question').value.trim();
    steps = [];
    currentStep = 0;

    if (!exprInput) {
        steps.push('â— Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ø¹Ø¨Ø§Ø±Øª Ø¹Ø¯Ø¯ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
        return;
    }

    if (!isBalanced(exprInput)) {
        steps.push('â— Ù¾Ø±Ø§Ù†ØªØ²Ù‡Ø§ÛŒ Ø¹Ø¨Ø§Ø±Øª Ù†Ø§Ù…ØªØ¹Ø§Ø¯Ù„ Ù‡Ø³ØªÙ†Ø¯.');
        return;
    }

    try {
        steps.push(Ø¹Ø¨Ø§Ø±Øª ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡: ${exprInput});
        steps.push('ğŸ”¹ Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆØ¬ÙˆØ¯ (Ø¬Ù…Ø¹ØŒ ØªÙØ±ÛŒÙ‚ØŒ Ø¶Ø±Ø¨ØŒ ØªÙ‚Ø³ÛŒÙ…ØŒ ØªÙˆØ§Ù†ØŒ Ø±Ø§Ø¯ÛŒÚ©Ø§Ù„ Ùˆ ØªÙˆØ§Ø¨Ø¹ Ø³Ø§Ø¯Ù‡)');
        const expr = math.parse(exprInput);
        steps.push(ğŸ”¹ Ù…Ø±Ø­Ù„Ù‡ Û²: Ù†Ù…Ø§ÛŒØ´ Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø§Ø®Ù„ÛŒ Ø¹Ø¨Ø§Ø±Øª: ${expr.toString()});
        const value = expr.evaluate();
        steps.push(ğŸ”¹ Ù…Ø±Ø­Ù„Ù‡ Û³: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ù†Ù‡Ø§ÛŒÛŒ: ${value});
    } catch {
        steps.push('âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡. Ù„Ø·ÙØ§Ù‹ ÙÙ‚Ø· Ø¹Ø¨Ø§Ø±Ø§Øª Ø¹Ø¯Ø¯ÛŒ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
    }
}

// Ù†Ù…Ø§ÛŒØ´ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯
function showNextStep() {
    if (currentStep < steps.length) {
        const stepsDiv = document.getElementById('steps');
        const div = document.createElement('div');
        div.className = 'step';
        div.textContent = steps[currentStep];
        stepsDiv.appendChild(div);
        currentStep++;
        if (currentStep === steps.length) {
            document.getElementById('nextButton').style.display = 'none';
        }
    }
}

document.getElementById('startButton').addEventListener('click', function() {
    document.getElementById('steps').innerHTML = '';
    prepareSteps();
    currentStep = 0;
    if (steps.length > 0) {
        document.getElementById('nextButton').style.display = 'inline-block';
        showNextStep();
    }
});

document.getElementById('nextButton').addEventListener('click', showNextStep);
</script>

</body>
</html>
