<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ماشین حساب حد گام به گام</title>
<script src="https://unpkg.com/algebrite"></script>
<style>
  body { font-family: Tahoma, sans-serif; margin: 40px; background: #f5f5f5; }
  h2 { color: #333; }
  input, button { padding: 8px; margin: 5px 0; width: 100%; font-size: 16px; }
  button { background: #4CAF50; color: white; border: none; cursor: pointer; border-radius: 5px; }
  button:hover { background: #45a049; }
  .result { margin-top: 20px; padding: 15px; background: #fff; border-radius: 10px; box-shadow: 1px 1px 10px rgba(0,0,0,0.1); }
  .step { margin-top: 10px; padding: 10px; border-left: 4px solid #4CAF50; background: #f9f9f9; }
  .error { color: red; font-weight: bold; }
</style>
</head>
<body>

<h2>ماشین حساب حد گام به گام</h2>

<label>تابع (مثال: sin(x)/x یا log(x)):</label>
<input type="text" id="func" placeholder="تابع خود را وارد کنید">

<label>نقطه حد (مثال: 2، Infinity یا -Infinity):</label>
<input type="text" id="point" placeholder="x → ">

<button onclick="calculateLimitStep()">محاسبه حد گام به گام</button>

<div class="result" id="output"></div>

<script>
function calculateLimitStep() {
    let f = document.getElementById("func").value.trim();
    let x0 = document.getElementById("point").value.trim();
    let output = document.getElementById("output");
    output.innerHTML = "";

    if(f === "" || x0 === "") {
        output.innerHTML = "<span class='error'>لطفا همه ورودی‌ها را پر کنید.</span>";
        return;
    }

    try {
        // تبدیل Infinity و -Infinity
        let point = x0.toLowerCase();
        if(point === "infinity") x0 = "inf";
        if(point === "-infinity") x0 = "-inf";

        // محاسبه حد چپ و راست
        let left = Algebrite.run(`limit(${f}, x, ${x0}, -1)`);
        let right = Algebrite.run(`limit(${f}, x, ${x0}, 1)`);
        let mainLimit = (left === right) ? left : "حد وجود ندارد";

        // نمایش گام به گام
        output.innerHTML += `<div class="step"><b>گام 1:</b> تابع وارد شده: f(x) = ${f}</div>`;
        output.innerHTML += `<div class="step"><b>گام 2:</b> نقطه حد: x → ${document.getElementById("point").value}</div>`;
        output.innerHTML += `<div class="step"><b>گام 3:</b> محاسبه حد چپ: lim(x→${document.getElementById("point").value}⁻) f(x) = ${left}</div>`;
        output.innerHTML += `<div class="step"><b>گام 4:</b> محاسبه حد راست: lim(x→${document.getElementById("point").value}⁺) f(x) = ${right}</div>`;

        if(left === right) {
            output.innerHTML += `<div class="step"><b>گام 5:</b> حد اصلی برابر است با: ${mainLimit}</div>`;
        } else {
            output.innerHTML += `<div class="step"><b>گام 5:</b> حد اصلی وجود ندارد زیرا حد چپ و حد راست برابر نیستند.</div>`;
        }

    } catch(e) {
        output.innerHTML = "<span class='error'>خطا در محاسبه تابع. لطفا تابع را بررسی کنید.</span>";
    }
}
</script>

</body>
</html>
