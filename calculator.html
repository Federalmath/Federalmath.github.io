<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ماشین حساب گام به گام انتگرال</title>
<style>
    body { font-family: Tahoma, sans-serif; background: #f0f0f0; padding: 20px; }
    .container { background: #fff; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.2);}
    input, select, button { padding: 8px; margin: 5px 0; width: 100%; border-radius: 6px; border: 1px solid #ccc;}
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background: #45a049; }
    .result { background: #e8f5e9; padding: 10px; border-radius: 8px; margin-top: 10px;}
    .step { margin-bottom: 10px; }
</style>
</head>
<body>
<div class="container">
<h2>ماشین حساب گام به گام انتگرال</h2>

<label>تابع (مثال: x^2 + 3*x):</label>
<input type="text" id="function" placeholder="f(x)">

<label>نوع انتگرال:</label>
<select id="integralType">
  <option value="indefinite">نامعین</option>
  <option value="definite">معین</option>
</select>

<div id="limits" style="display:none;">
  <label>حد پایین:</label>
  <input type="text" id="lower">
  <label>حد بالا:</label>
  <input type="text" id="upper">
</div>

<button id="calculateBtn">محاسبه گام به گام</button>

<div id="result" class="result"></div>
</div>

<!-- اضافه کردن کتابخانه Algebrite -->
<script src="https://cdn.jsdelivr.net/npm/algebrite@1.5.0/dist/algebrite.bundle-for-browser.min.js"></script>

<script>
document.getElementById('integralType').addEventListener('change', function() {
    document.getElementById('limits').style.display = this.value === 'definite' ? 'block' : 'none';
});

document.getElementById('calculateBtn').addEventListener('click', function() {
    let func = document.getElementById('function').value;
    let type = document.getElementById('integralType').value;
    let lower = document.getElementById('lower').value;
    let upper = document.getElementById('upper').value;
    let resultDiv = document.getElementById('result');
    resultDiv.innerHTML = '';

    if (!func) { resultDiv.innerHTML = "لطفاً تابع را وارد کنید."; return; }

    try {
        // گام 1: نمایش تابع ورودی
        resultDiv.innerHTML += `<div class="step"><b>گام 1:</b> تابع وارد شده: ${func}</div>`;

        // گام 2: ایجاد انتگرال
        let integralExpr = `integral(${func}, x)`;
        if (type === 'definite') {
            if(lower === '' || upper === '') {
                resultDiv.innerHTML += "لطفاً حدهای انتگرال را وارد کنید.";
                return;
            }
            integralExpr = `integral(${func}, x, ${lower}, ${upper})`;
        }

        resultDiv.innerHTML += `<div class="step"><b>گام 2:</b> فرم انتگرال: ${integralExpr}</div>`;

        // گام 3: محاسبه با Algebrite
        let integralResult = Algebrite.run(integralExpr);
        resultDiv.innerHTML += `<div class="step"><b>گام 3:</b> نتیجه: ${integralResult}</div>`;
    } catch(e) {
        resultDiv.innerHTML = "خطا در محاسبه: " + e.message;
    }
});
</script>
</body>
</html>
