<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>حد عددی بدون Algebrite</title>
<style>
  body { font-family: Tahoma, sans-serif; margin: 40px; background: #f5f5f5; }
  h2 { color: #333; }
  input, button { padding: 8px; margin: 5px 0; width: 100%; font-size: 16px; }
  button { background: #4CAF50; color: white; border: none; cursor: pointer; border-radius: 5px; }
  button:hover { background: #45a049; }
  .result { margin-top: 20px; padding: 15px; background: #fff; border-radius: 10px; box-shadow: 1px 1px 10px rgba(0,0,0,0.1); }
  .step { margin-top: 10px; padding: 10px; border-left: 4px solid #4CAF50; background: #f9f9f9; }
  .error { color: red; font-weight: bold; }
</style>
</head>
<body>

<h2>ماشین حساب حد عددی</h2>

<label>تابع (مثال: Math.sin(x)/x یا Math.log(x)):</label>
<input type="text" id="func" placeholder="تابع خود را وارد کنید">

<label>نقطه حد (مثال: 0 یا Infinity یا -Infinity):</label>
<input type="text" id="point" placeholder="x → ">

<button onclick="calculateNumericLimit()">محاسبه حد</button>

<div class="result" id="output"></div>

<script>
function calculateNumericLimit() {
    const output = document.getElementById("output");
    output.innerHTML = "";

    const fStr = document.getElementById("func").value.trim();
    let x0 = document.getElementById("point").value.trim();

    if(fStr === "" || x0 === "") {
        output.innerHTML = "<span class='error'>لطفا همه ورودی‌ها را پر کنید.</span>";
        return;
    }

    // تبدیل نقطه حد به عدد یا Infinity
    if(x0.toLowerCase() === "infinity") x0 = Infinity;
    else if(x0.toLowerCase() === "-infinity") x0 = -Infinity;
    else x0 = parseFloat(x0);

    // تابع eval ایمن
    const f = (x) => {
        try {
            return eval(fStr);
        } catch(e) {
            return NaN;
        }
    }

    // گام عددی
    const h = 1e-7;

    let left, right;

    try {
        left = f(x0 - h);
        right = f(x0 + h);

        if(!isFinite(left)) left = left > 0 ? "∞" : "-∞";
        if(!isFinite(right)) right = right > 0 ? "∞" : "-∞";

        let mainLimit = (left === right) ? left : "حد وجود ندارد";

        output.innerHTML += `<div class="step"><b>حد چپ:</b> ${left}</div>`;
        output.innerHTML += `<div class="step"><b>حد راست:</b> ${right}</div>`;
        output.innerHTML += `<div class="step"><b>حد اصلی:</b> ${mainLimit}</div>`;

    } catch(e) {
        output.innerHTML = "<span class='error'>خطا در محاسبه تابع. لطفا تابع را بررسی کنید.</span>";
    }
}
</script>

</body>
</html>
